<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<title>CUNY#WORKS</title>
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
<!-- Latest compiled and minified JavaScript -->
<script src="https://code.jquery.com/jquery-3.2.1.min.js"
	integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	crossorigin="anonymous"></script>

<!--[if lt IE 9]>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
<link rel="stylesheet" media="all"
	href="http://localhost:9999/cunyworks/assets/bootstrap/css/bootstrap.min.css">
<link href="http://localhost:9999/cunyworks/assets/css/style.css"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"
	integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
	crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"
	integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n"
	crossorigin="anonymous"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"
	integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
	crossorigin="anonymous"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"
	integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"
	crossorigin="anonymous"></script>



</head>
<body>

	<header id="header">
		<div class="container">
			<a href="Yani.html" id="logo-1" title="CunyWorks">CUNY#Works</a>
			<div class="menu-trigger"></div>
			<nav id="menu">
				<ul>
					<li><a href="events.html">Courses</a></li>
					<li><a href="gallery.html">Students</a></li>
				</ul>

				<ul>
					<li><a href="gallery.html">Teachers</a></li>
					<li><a href="#" class="get-contact">Contact</a></li>
				</ul>
			</nav>
			<!-- / navigation -->
		</div>
		<!-- / container -->

	</header>
	<!-- / header -->
	<div class="divider"></div>

	<table id="courseTable" class="table table-inverse">
		<thead>
			<tr>
				<th>ID</th>
				<th>Course Name</th>
				<th>Enrollment Capacity</th>
				<th>Room</th>
				<th>Schedule Time</th>
				<th>Start Date</th>
				<th>End Date</th>
				<!-- <th>Syllabus</th> -->
				<th></th>
			</tr>
		</thead>
		<tbody>


		</tbody>
	</table>

	<section class="posts"></section>


	<section class="events">

		<!-- / container -->
	</section>

	<footer id="footer">
		<div class="container">
			<section>Build by Status418</section>

		</div>
		<!-- / container -->
	</footer>
	<!-- / footer -->



	<div id="myModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
					<h4 class="modal-title">Enroll in courses</h4>
				</div>
			
				<div class="modal-body" id="orderDetails">
					<div class="fancybox">
					
						<div class="left">

							<fieldset class="subject">
								<input id="nameOfClass" type="text" readonly>
							</fieldset>

						</div>
						<div class="right">
							<fieldset class="question">
								<textarea   id="descOfClass" readonly> </textarea>
							</fieldset>
						</div>
						<input type="hidden" id="idOfClass">
						<div class="btn-holder">
							<button id="add" class="btn blue" type="submit">Enroll</button>
						</div>
	
				</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>





	<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script>
		window.jQuery
				|| document
						.write("<script src='http://localhost:9999/cunyworks/resources/js/jquery-1.11.1.min.js'>\x3C/script>")
	</script>
	<script src="http://localhost:9999/cunyworks/assets/js/plugins.js"></script>
	<script src="http://localhost:9999/cunyworks/assets/js/main.js"></script>
	<script
		src="http://localhost:9999/cunyworks/assets/bootstrap/js/bootstrap.min.js"></script>
</body>
<script type="text/javascript">
	$(function() {

		fetchstuff();
		
		

		$("#add").click(function() {
			var courseId = $("#idOfClass").val();
			var studentId = 1;

			$.ajax("http://localhost:9999/cunyworks/student/new", {
				method : "POST",
				contentType : "application/json",
				data : JSON.stringify({
					studentN : studentId,
					courseN : courseId
				}),
				success : function(response) {
					alert(response);
				}
			});

		});

		function fetchstuff() {
			$.ajax("http://localhost:9999/cunyworks/student/new_courses", {
				method : "GET",
				dataType : "json",
				success : function(response) {
					console.log(response);
					tablewipe();
					tableload(response);
				}
			});
		}

		function tablewipe() {
			$("#courseTable tbody").empty();
		}

		function tableload(response) {
			$.each(response, function(index, temp) {
				$("#courseTable tbody").append(
						'<tr data-toggle="modal" data-target="#myModal" data-id='+temp.courseId+' >'
								+ '<td scope="row">'
								+ temp.courseId
								+ '</td>'
								+ "<td id='cname'>"
								+ temp.subject.name
								+ "</td>"
								+ "<td>"
								+ temp.enrollmentCapacity
								+ "</td>"
								+ "<td>"
								+ temp.room
								+ "</td>"
								+ "<td>"
								+ temp.scheduleTime
								+ "</td>"
								+ "<td>"
								+ temp.startDate
								+ "</td>"
								+ "<td>"
								+ temp.endDate
								+ "</td>"
							/* 	+ "<td><a href='#'>"
								+ temp.syllabus
								+ "</a></td>" */
								+ "<td style='visibility: hidden;'>"
								+ temp.description
								+ "</td>"
								+ "</tr>");

			});
		}

		$('#myModal').on(
				'show.bs.modal',
				function(event) {
					//var getIdFromRow = $(event.relatedTarget).attr('data-id');
					// if you wnat to take the text of the first cell 
					var getIdFromRow = $(event.relatedTarget).find(
							'td:first-child').text();
					var getNameFromRow = $(event.relatedTarget).find(
							'td:nth-child(2)').text();
					var getDescFromRow = $(event.relatedTarget).find(
							'td:nth-child(8)').text();
					$("#idOfClass").val(getIdFromRow);		
					$("#nameOfClass").val(getNameFromRow);
					$("#descOfClass").val(getDescFromRow);	
			
				});

	});
</script>
</html>

